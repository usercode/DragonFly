@page "/tasks"
@inherits BackgroundTaskListBase

<div class="content-header">
    <h1>Tasks</h1>

    <Toolbar Items="ToolbarItems"></Toolbar>
</div>
<div class="scroll-content">
    @if (Tasks != null)
    {
        <ul class="list-group">
            @foreach (BackgroundTaskInfo task in Tasks)
            {
                BackgroundTaskInfo t = task;

                <li class="list-group-item @task.ToCss()">
                    <BSRow>
                        <BSCol ColumnLarge="1">
                            <span>@task.Id </span>
                        </BSCol>
                        <BSCol ColumnLarge="1">
                            <span>
                                @if (task.State == BackgroundTaskState.Running)
                                {
                                    <i class="fa-solid fa-sync fa-spin" style="margin-right: 0.5rem"></i>
                                }
                                @task.State
                            </span>
                        </BSCol>
                        <BSCol ColumnLarge="1">
                            <BSProgressBar Min="0" Max="task.ProgressMaxValue" Value="task.ProgressValue">@task.ProgressValue / @task.ProgressMaxValue</BSProgressBar>
                        </BSCol>
                        <BSCol ColumnLarge="4">
                            <span>@task.Name </span>
                        </BSCol>
                        <BSCol ColumnLarge="2">
                            <span>@task.CreatedBy </span>
                        </BSCol>
                        <BSCol ColumnLarge="2">
                            @if (task.State == BackgroundTaskState.Running)
                            {
                                <span>@task.Status</span>
                            }
                            else
                            {
                                <span>@task.Exception</span>
                            }
                        </BSCol>
                        <BSCol ColumnLarge="1">
                            @if (task.State == BackgroundTaskState.Running)
                            {
                                <BSButton Color="BSColor.Light" OnClick="async x => await CancelTask(t)">Cancel</BSButton>
                            }
                        </BSCol>
                    </BSRow>
                </li>
            }
        </ul>
    }
</div>
<div class="footer-content">
    <div class="row">
    </div>
</div>

@code {

}
